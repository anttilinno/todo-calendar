---
milestone: v2.3
audited: 2026-02-23
status: passed
scores:
  requirements: 5/5
  phases: 2/2
  integration: 4/4
  flows: 2/2
gaps:
  requirements: []
  integration: []
  flows: []
tech_debt:
  - phase: 36-status-subcommand
    items:
      - "Test uses non-existent theme name 'catppuccin' — silently falls back to Dark(); cosmetic, no runtime impact"
  - phase: 37-tui-state-file-integration
    items:
      - "Same 'catppuccin' theme name in integration tests (TestRefreshStatusFileEndToEnd, TestRefreshStatusFileAllDone)"
---

# v2.3 Polybar Status — Milestone Audit

**Audited:** 2026-02-23
**Status:** passed
**Score:** 5/5 requirements satisfied

## Phase Summary

| Phase | Status | Verification | Requirements Covered |
|-------|--------|-------------|---------------------|
| 36: Status Subcommand | Complete | passed (9/9 truths) | BAR-01, BAR-02, BAR-03 |
| 37: TUI State File Integration | Complete | passed (6/6 truths) | BAR-04, BAR-05 |

## Requirements Cross-Reference (3-Source)

| REQ-ID | Description | VERIFICATION.md | SUMMARY Refs | REQUIREMENTS.md | Final Status |
|--------|-------------|----------------|--------------|-----------------|--------------|
| BAR-01 | Run `todo-calendar status` to write pending count to state file | passed (36-VERIFICATION) | 36-01, 36-02 | [x] Complete | **satisfied** |
| BAR-02 | Output format `%{F#hex}ICON COUNT%{F-}` with priority color | passed (36-VERIFICATION) | 36-01, 36-02 | [x] Complete | **satisfied** |
| BAR-03 | Empty string when zero pending todos | passed (36-VERIFICATION) | 36-01, 36-02 | [x] Complete | **satisfied** |
| BAR-04 | TUI updates state file on todo mutations | passed (37-VERIFICATION) | 37-01 | [x] Complete | **satisfied** |
| BAR-05 | TUI writes initial state file on startup | passed (37-VERIFICATION) | 37-01 | [x] Complete | **satisfied** |

### Orphan Detection

No orphaned requirements. All 5 REQ-IDs are assigned to phases in the traceability table and verified by their respective phase VERIFICATION.md files.

## Integration Report

### Cross-Phase Wiring

| Export | From | To | Status |
|--------|------|----|--------|
| `status.FormatStatus` | Phase 36 (status/status.go) | Phase 37 (app/model.go:623) | WIRED |
| `status.WriteStatusFile` | Phase 36 (status/status.go) | Phase 37 (app/model.go:624) | WIRED |
| `theme.PriorityColorHex` | Phase 36 (theme/theme.go) | Phase 36 (status/status.go:41) | WIRED |
| `store.TodosForDateRange` | Existing | Both phases (main.go:73, model.go:622) | WIRED |

**Orphaned exports:** 0
**Missing connections:** 0

Phase 37's `refreshStatusFile` method calls Phase 36's `status.FormatStatus` and `status.WriteStatusFile` — the exact same code path as the CLI subcommand, guaranteeing identical output format.

## E2E Flows

### Flow 1: CLI Status (BAR-01, BAR-02, BAR-03)

```
main.go:41 → os.Args[1] == "status"
  → runStatus(cfg, s)
  → s.TodosForDateRange(today, today)
  → status.FormatStatus(todos, t) → PriorityColorHex → %{F#hex}ICON COUNT%{F-}
  → status.WriteStatusFile(output) → atomic write → /tmp/.todo_status
  → return (exit 0)
```

**Result:** COMPLETE

### Flow 2: TUI Refresh (BAR-04, BAR-05)

```
Startup: Init() → refreshStatusFile() → FormatStatus + WriteStatusFile
Mutations: Update() bottom → refreshStatusFile() [add, toggle, delete, edit, reorder]
Body edits: EditorFinishedMsg → refreshStatusFile()
Theme changes: SettingChangedMsg → refreshStatusFile()
```

**Result:** COMPLETE

## Tech Debt

| Phase | Item | Severity |
|-------|------|----------|
| 36, 37 | Tests use `theme.ForName("catppuccin")` which silently falls back to `Dark()` | Info |

**Total:** 1 item (cosmetic only, no blockers)

## Human Verification Items

1. **Polybar live integration** — add `exec = todo-calendar status; cat /tmp/.todo_status` to Polybar module, verify rendering
2. **Exit code under error** — remove DB read permission, verify `todo-calendar status` exits with code 1
3. **Real-time TUI update** — run TUI, watch `/tmp/.todo_status` in another terminal, add/toggle todos
4. **Theme change color** — change theme in TUI settings, verify state file color updates

---

_Audited: 2026-02-23_
_Auditor: Claude (gsd-audit-milestone)_

---
phase: 01-tui-scaffold
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - go.mod
  - go.sum
  - main.go
  - internal/app/model.go
  - internal/app/keys.go
  - internal/app/styles.go
  - internal/calendar/model.go
  - internal/todolist/model.go
autonomous: false

must_haves:
  truths:
    - "User runs the binary and sees a split-pane layout with distinct left and right panels"
    - "User can switch focus between panes with Tab, and the focused pane has a visually distinct border"
    - "User can resize the terminal and the layout adjusts without breaking or panicking"
    - "User can quit the app with q or Ctrl+C"
  artifacts:
    - path: "main.go"
      provides: "Program entry point with tea.NewProgram and tea.WithAltScreen"
      contains: "tea.NewProgram"
    - path: "internal/app/model.go"
      provides: "Root model with Init, Update, View; focus routing; WindowSizeMsg broadcast"
      exports: ["Model", "New"]
      min_lines: 60
    - path: "internal/app/keys.go"
      provides: "KeyMap with Quit (q, ctrl+c) and Tab bindings"
      exports: ["KeyMap", "DefaultKeyMap"]
    - path: "internal/app/styles.go"
      provides: "Focused and unfocused pane styles with distinct border colors"
      contains: "focusedBorderColor"
    - path: "internal/calendar/model.go"
      provides: "Placeholder calendar pane model with SetFocused, Update, View"
      exports: ["Model", "New"]
    - path: "internal/todolist/model.go"
      provides: "Placeholder todolist pane model with SetFocused, Update, View"
      exports: ["Model", "New"]
  key_links:
    - from: "internal/app/model.go"
      to: "internal/calendar/model.go"
      via: "import and composition"
      pattern: "calendar\\.New\\(\\)"
    - from: "internal/app/model.go"
      to: "internal/todolist/model.go"
      via: "import and composition"
      pattern: "todolist\\.New\\(\\)"
    - from: "internal/app/model.go"
      to: "internal/app/keys.go"
      via: "key.Matches for routing"
      pattern: "key\\.Matches\\(msg, m\\.keys\\."
    - from: "internal/app/model.go"
      to: "internal/app/styles.go"
      via: "paneStyle function for focus-aware borders"
      pattern: "paneStyle\\("
    - from: "main.go"
      to: "internal/app/model.go"
      via: "app.New() passed to tea.NewProgram"
      pattern: "app\\.New\\(\\)"
---

<objective>
Set up the Go project and implement a split-pane Bubble Tea TUI scaffold with keyboard navigation and responsive resize handling.

Purpose: Establish the foundational application skeleton that all subsequent phases build on. The root model, child component pattern, focus routing, and layout composition are the architectural backbone.
Output: A runnable `go run .` binary that displays two bordered panes side by side, supports Tab to switch focus (with visual border change), handles terminal resize, and quits on q/Ctrl+C.
</objective>

<execution_context>
@/home/antti/.claude/get-shit-done/workflows/execute-plan.md
@/home/antti/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-tui-scaffold/01-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Initialize Go project and install dependencies</name>
  <files>go.mod, go.sum</files>
  <action>
Initialize the Go module and install the three Charm libraries at their locked versions:

```bash
go mod init github.com/antti/todo-calendar
go get github.com/charmbracelet/bubbletea@v1.3.10
go get github.com/charmbracelet/lipgloss@v1.1.0
go get github.com/charmbracelet/bubbles@v0.21.1
```

Verify go.mod contains all three dependencies at the correct versions. Do NOT install any other libraries -- Phase 1 needs only these three.
  </action>
  <verify>
Run `go mod tidy` and confirm it exits cleanly. Inspect go.mod to confirm:
- Module path: `github.com/antti/todo-calendar`
- `bubbletea v1.3.10` (or compatible resolved version)
- `lipgloss v1.1.0` (or compatible resolved version)
- `bubbles v0.21.1` (or compatible resolved version)
  </verify>
  <done>go.mod and go.sum exist with all three Charm dependencies at their specified versions.</done>
</task>

<task type="auto">
  <name>Task 2: Implement split-pane scaffold with keyboard navigation and resize handling</name>
  <files>
    main.go
    internal/app/model.go
    internal/app/keys.go
    internal/app/styles.go
    internal/calendar/model.go
    internal/todolist/model.go
  </files>
  <action>
Create all source files following the patterns and code examples from the RESEARCH document. Reference `@.planning/phases/01-tui-scaffold/01-RESEARCH.md` for the complete code examples.

**main.go** -- Minimal entry point:
- Create `app.New()` root model
- Wrap in `tea.NewProgram(model, tea.WithAltScreen())`
- Call `Run()`, print error to stderr and `os.Exit(1)` on failure
- Nothing else in main.go

**internal/app/keys.go** -- Key bindings:
- Define `KeyMap` struct with `Quit` and `Tab` as `key.Binding` fields
- `Quit` binds to `"q"` and `"ctrl+c"` with help text `"quit"`
- `Tab` binds to `"tab"` with help text `"switch pane"`
- Implement `ShortHelp()` and `FullHelp()` methods on KeyMap (for future help.KeyMap interface compatibility)
- Export `DefaultKeyMap()` constructor

**internal/app/styles.go** -- Pane styling:
- Define `focusedBorderColor` (lipgloss.Color "62", purple) and `unfocusedBorderColor` (lipgloss.Color "240", gray)
- Create `focusedStyle` and `unfocusedStyle` package-level vars using `lipgloss.NewStyle().Border(lipgloss.RoundedBorder()).BorderForeground(...).Padding(0, 1)`
- Export a `paneStyle(focused bool) lipgloss.Style` function that returns the appropriate style

**internal/calendar/model.go** -- Placeholder calendar pane:
- Struct with `focused bool`, `width int`, `height int` fields
- `New()` constructor returns zero-value Model
- `Update(msg tea.Msg) (Model, tea.Cmd)` -- handles `tea.WindowSizeMsg` to store dimensions, returns concrete `Model` type (NOT `tea.Model`)
- `View() string` -- returns `"Calendar"` or `"Calendar (focused)"` based on focus state
- `SetFocused(f bool)` -- pointer receiver to mutate focus state
- Do NOT implement `Init()` (child models do not need it)

**internal/todolist/model.go** -- Placeholder todo pane:
- Same structure as calendar placeholder but with `"Todo List"` / `"Todo List (focused)"` labels
- Same Update/View/SetFocused pattern

**internal/app/model.go** -- Root model (the core of Phase 1):
- Define `pane` type as `int` with `calendarPane` and `todoPane` constants via iota
- `Model` struct with fields: `calendar calendar.Model`, `todoList todolist.Model`, `activePane pane`, `width int`, `height int`, `ready bool`, `keys KeyMap`
- `New()` constructor: creates calendar.New(), todolist.New(), sets activePane to calendarPane, initializes keys with DefaultKeyMap(), sets calendar as focused by default
- `Init() tea.Cmd` returns nil
- `Update(msg tea.Msg) (tea.Model, tea.Cmd)`:
  1. Handle `tea.KeyMsg` first for global keys:
     - `key.Matches(msg, m.keys.Quit)` -> return `tea.Quit`
     - `key.Matches(msg, m.keys.Tab)` -> toggle activePane, call SetFocused on both children
  2. Handle `tea.WindowSizeMsg` as special broadcast:
     - Store width/height on root model
     - Set `m.ready = true`
     - Forward to BOTH calendar.Update AND todoList.Update
     - Return with batched commands
  3. Default: route message to focused child only based on activePane
- `View() string`:
  1. If `!m.ready`, return `"Initializing..."`
  2. Calculate frame overhead using `paneStyle(true).GetFrameSize()` (focused style has same frame as unfocused)
  3. Set `helpHeight := 1` for the status bar
  4. Calculate `contentHeight := m.height - helpHeight - frameV` (where frameV comes from GetFrameSize)
  5. Set calendar inner width to 24 (enough for month grid)
  6. Calculate todo inner width as `m.width - calendarInnerWidth - (frameH * 2)` (both panes have frames)
  7. **Clamp both widths to minimum of 1** -- if terminal too narrow, show "Terminal too small" message instead of layout (check if todoInnerWidth < 1)
  8. Apply paneStyle with Width and Height to both panes based on focus state
  9. Join panes horizontally with `lipgloss.JoinHorizontal(lipgloss.Top, ...)`
  10. Add a plain-string status bar: `"q: quit | Tab: switch pane"`
  11. Join top + statusBar vertically with `lipgloss.JoinVertical(lipgloss.Left, ...)`

**Critical patterns to follow (from RESEARCH):**
- Child Update returns concrete type `(calendar.Model, tea.Cmd)`, NOT `(tea.Model, tea.Cmd)`. No type assertions needed in root.
- WindowSizeMsg is broadcast to ALL children, not just focused one.
- Ready guard prevents layout calculation with zero dimensions.
- Width clamping prevents negative widths on very narrow terminals.
- Use `key.Matches()` from bubbles/key, NOT `msg.String() == "q"` string comparison.
- Use `paneStyle().GetFrameSize()` for frame measurement, NOT manual counting.
  </action>
  <verify>
1. Run `go build ./...` -- must compile without errors.
2. Run `go vet ./...` -- must pass with no warnings.
3. Run `go run .` -- app must launch in alt screen showing two bordered panes side by side.
4. Press Tab -- focused pane border color must change (purple to gray and vice versa), and the other pane label should show "(focused)".
5. Resize the terminal -- layout must adjust without panic or garbled output.
6. Press q -- app must exit cleanly back to normal terminal.
7. Test Ctrl+C -- app must also exit cleanly.
  </verify>
  <done>
`go run .` launches a full-screen TUI with two bordered panes. Tab switches focus with visual border change. Resize adjusts layout. q and Ctrl+C quit cleanly. All code compiles and passes vet.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Split-pane TUI scaffold with keyboard navigation, focus-aware borders, resize handling, and quit functionality.</what-built>
  <how-to-verify>
1. Run `go run .` in the project directory
2. Verify you see two bordered panes side by side: "Calendar (focused)" on the left, "Todo List" on the right
3. Verify the left pane has a colored (purple) border and the right has a dim (gray) border
4. Press Tab -- left should dim, right should highlight, labels should swap focus indication
5. Press Tab again -- should toggle back
6. Resize the terminal window -- layout should adjust smoothly, no crashes or garbled output
7. Try making the terminal very narrow (under ~50 cols) -- should show "Terminal too small" or degrade gracefully
8. Press q to quit -- should return to normal terminal cleanly
9. Run again and press Ctrl+C -- should also quit cleanly
10. Verify a status bar at the bottom reads "q: quit | Tab: switch pane" or similar
  </how-to-verify>
  <resume-signal>Type "approved" or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
- `go build ./...` compiles without errors
- `go vet ./...` passes clean
- Binary launches in alt screen with two distinct bordered panes
- Tab toggles focus with visible border color change on both panes
- Terminal resize updates layout dynamically
- q and Ctrl+C both quit the application cleanly
- No panics on narrow terminal (graceful degradation)
</verification>

<success_criteria>
1. Running `go run .` shows a split-pane layout with left (calendar placeholder) and right (todo placeholder) panels
2. Pressing Tab switches the focused pane, indicated by a distinct border color change
3. Resizing the terminal adjusts both panes proportionally without crashes
4. Pressing q or Ctrl+C exits the application cleanly
5. All code follows the Bubble Tea patterns: child concrete types, ready guard, WindowSizeMsg broadcast, key.Matches routing
</success_criteria>

<output>
After completion, create `.planning/phases/01-tui-scaffold/01-01-SUMMARY.md`
</output>

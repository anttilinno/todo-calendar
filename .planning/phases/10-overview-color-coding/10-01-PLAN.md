---
phase: 10-overview-color-coding
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - internal/theme/theme.go
  - internal/store/store.go
  - internal/calendar/styles.go
  - internal/calendar/model.go
autonomous: true

must_haves:
  truths:
    - "Overview panel displays separate pending and completed counts per month"
    - "Pending counts render in a red-family color, completed counts in a green-family color"
    - "Overview colors change when user switches themes (all 4 themes define both roles)"
    - "Floating (undated) todos also show pending/completed split"
  artifacts:
    - path: "internal/theme/theme.go"
      provides: "PendingFg and CompletedCountFg color roles in Theme struct"
      contains: "PendingFg"
    - path: "internal/store/store.go"
      provides: "MonthCount with Pending+Completed fields, FloatingCount struct, FloatingTodoCounts method"
      contains: "Pending"
    - path: "internal/calendar/styles.go"
      provides: "OverviewPending and OverviewCompleted lipgloss styles"
      contains: "OverviewPending"
    - path: "internal/calendar/model.go"
      provides: "renderOverview displaying split colored counts"
      contains: "OverviewPending"
  key_links:
    - from: "internal/theme/theme.go"
      to: "internal/calendar/styles.go"
      via: "NewStyles() reads t.PendingFg and t.CompletedCountFg"
      pattern: "t\\.PendingFg|t\\.CompletedCountFg"
    - from: "internal/store/store.go"
      to: "internal/calendar/model.go"
      via: "renderOverview calls store.TodoCountsByMonth and store.FloatingTodoCounts"
      pattern: "m\\.store\\.TodoCountsByMonth|m\\.store\\.FloatingTodoCounts"
    - from: "internal/calendar/styles.go"
      to: "internal/calendar/model.go"
      via: "renderOverview uses m.styles.OverviewPending and m.styles.OverviewCompleted"
      pattern: "m\\.styles\\.OverviewPending|m\\.styles\\.OverviewCompleted"
---

<objective>
Add theme-aware color-coded pending/completed counts to the overview panel.

Purpose: Users currently see a single total count per month in the overview. Splitting into pending (red-family) and completed (green-family) counts lets users see completion progress at a glance -- which months have work remaining and which are done.

Output: Modified theme, store, styles, and rendering files. Overview shows two colored numbers per month instead of one bracketed total.
</objective>

<execution_context>
@/home/antti/.claude/get-shit-done/workflows/execute-plan.md
@/home/antti/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/10-overview-color-coding/10-RESEARCH.md
@internal/theme/theme.go
@internal/store/store.go
@internal/calendar/styles.go
@internal/calendar/model.go
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add theme color roles and split store counts</name>
  <files>internal/theme/theme.go, internal/store/store.go</files>
  <action>
1. In `internal/theme/theme.go`, add two new fields to the `Theme` struct under a new `// Overview` comment group:
   - `PendingFg lipgloss.Color` -- pending todo count in overview
   - `CompletedCountFg lipgloss.Color` -- completed todo count in overview

2. Set values in all 4 theme functions:
   - `Dark()`: PendingFg = `#D75F5F` (warm rose), CompletedCountFg = `#87AF87` (soft sage)
   - `Light()`: PendingFg = `#D70000` (medium red), CompletedCountFg = `#008700` (forest green)
   - `Nord()`: PendingFg = `#BF616A` (nord11 aurora red), CompletedCountFg = `#A3BE8C` (nord14 aurora green)
   - `Solarized()`: PendingFg = `#DC322F` (solarized red), CompletedCountFg = `#859900` (solarized green)

3. In `internal/store/store.go`, modify the `MonthCount` struct: replace the single `Count int` field with `Pending int` and `Completed int`.

4. Rewrite `TodoCountsByMonth()` to split counts by `t.Done`:
   - Use a `map[ym]*MonthCount` to accumulate per-key pending and completed counts
   - If `t.Done` is true, increment `Completed`; otherwise increment `Pending`
   - Collect into sorted slice as before

5. Add a new `FloatingCount` struct with `Pending int` and `Completed int` fields.

6. Replace `FloatingTodoCount() int` with `FloatingTodoCounts() FloatingCount`:
   - Iterate todos with `!t.HasDate()`
   - Split by `t.Done` into Pending and Completed
   - Return the struct
   - Remove the old `FloatingTodoCount()` method entirely (the only caller is `renderOverview` which will be updated in Task 2)
  </action>
  <verify>Run `go build ./...` from project root -- must compile with no errors. The build will fail if any caller still references the old `Count` field or `FloatingTodoCount()` method, which Task 2 will fix. If Task 2 is not yet applied, expect build errors in `calendar/model.go` only.</verify>
  <done>Theme struct has 16 color roles (14 existing + PendingFg + CompletedCountFg). All 4 themes define both new fields with appropriate palette colors. MonthCount has Pending+Completed instead of Count. FloatingTodoCounts() returns FloatingCount struct. Old FloatingTodoCount() removed.</done>
</task>

<task type="auto">
  <name>Task 2: Add overview styles and update renderOverview</name>
  <files>internal/calendar/styles.go, internal/calendar/model.go</files>
  <action>
1. In `internal/calendar/styles.go`, add two new fields to the `Styles` struct:
   - `OverviewPending lipgloss.Style`
   - `OverviewCompleted lipgloss.Style`

2. In `NewStyles()`, wire the new styles from theme fields:
   - `OverviewPending: lipgloss.NewStyle().Foreground(t.PendingFg)`
   - `OverviewCompleted: lipgloss.NewStyle().Foreground(t.CompletedCountFg)`

3. In `internal/calendar/model.go`, rewrite `renderOverview()`:
   - For each `MonthCount`, build the line in parts to avoid ANSI alignment issues:
     a. Format label with padding: `paddedLabel := fmt.Sprintf(" %-16s", label)`
     b. Style the label: apply `OverviewActive` if current month, else `OverviewCount`
     c. Style pending count: `m.styles.OverviewPending.Render(fmt.Sprintf("%d", mc.Pending))`
     d. Style completed count: `m.styles.OverviewCompleted.Render(fmt.Sprintf("%d", mc.Completed))`
     e. Concatenate: styledLabel + pending + "  " + completed
   - For the floating row, call `m.store.FloatingTodoCounts()` (returns `FloatingCount` struct) and render the same way with pending and completed styled separately
   - Do NOT use `fmt.Sprintf` width specifiers on pre-styled strings (causes ANSI misalignment)
   - Always show both numbers including zeros for consistency
  </action>
  <verify>Run `go build ./...` from project root -- must compile with zero errors. Run `go vet ./...` -- must pass. Then run the app with `go run .` and verify: (1) overview shows two numbers per month row instead of one bracketed number, (2) the first number appears in a red-ish color and the second in a green-ish color, (3) switch theme in settings and confirm colors update.</verify>
  <done>Calendar Styles struct has 11 fields (9 existing + OverviewPending + OverviewCompleted). renderOverview() displays pending and completed counts separately with distinct theme-aware colors. Floating row also shows split counts. Build and vet pass clean.</done>
</task>

</tasks>

<verification>
1. `go build ./...` compiles without errors
2. `go vet ./...` passes without warnings
3. Run the app: overview panel shows two numbers per month (pending in red-family, completed in green-family)
4. Toggle a todo done/undone: overview counts update live (pending decreases, completed increases or vice versa)
5. Switch theme in settings: overview colors change to match the new theme's palette
6. Month with zero pending or zero completed: shows "0" in the appropriate color (no blank/missing number)
</verification>

<success_criteria>
- Overview displays split pending + completed counts per month with distinct colors
- All 4 themes (Dark, Light, Nord, Solarized) define PendingFg and CompletedCountFg
- Colors propagate through the existing SetTheme -> NewStyles path
- No hardcoded color values in rendering code
- Build and vet pass clean
</success_criteria>

<output>
After completion, create `.planning/phases/10-overview-color-coding/10-01-SUMMARY.md`
</output>
